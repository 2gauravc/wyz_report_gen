<!-- templates/student_report_2page.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ report_title }}</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; color:#111; margin: 18px; }
    .page { max-width: 900px; margin: 0 auto; }
    .page-break { page-break-before: always; break-before: page; }

    .top-row { display:flex; align-items:center; gap:12px; }
    .logo { width:84px; height:auto; }
    .title-wrap { flex:1; text-align:center; }
    h1 { margin:4px 0 8px 0; font-size:20px; letter-spacing:0.6px; }
    .school-line { font-size:16px; font-weight:700; margin-top:6px; }

    .card { border:2px solid #000; padding:10px; margin-top:10px; }
    .grid-2col { display:flex; gap:12px; }
    .col { flex:1; }

    .grid-2col.adm-row { 
      display: flex; 
      gap: 96px; 
      flex-wrap: nowrap;      /* IMPORTANT: prevent dropping below */
      align-items: flex-start;
    }

    .grid-2col.adm-row .adm-grid { 
      flex: 0 0 60%; 
      max-width: 60%;
      min-width: 0;           /* IMPORTANT: allow flex item to shrink */
    }

    .grid-2col.adm-row .adm-side { 
      flex: 0 0 40%; 
      max-width: 40%;
      min-width: 0;           /* IMPORTANT */
    }
    
    .adm-side {
    border: 2px solid #000;
    padding: 16px;
    box-sizing: border-box;
    }
    .adm-side-title {
      font-weight: 800;
      font-size: 16px;
      margin-bottom: 12px;
    }
    .adm-metric-line {
      margin-bottom: 10px;
      font-size: 14px;
    }
    .adm-side{
      line-height: 1.5;
    }
    .adm-side{
      margin-top: 12px;   /* tweak 28–40px to match your quad-title height */
    }

    .adm-metric-line,
    .adm-belongs,
    .adm-note{
      margin-bottom: 10px;
    }
    
    .adm-belongs-label{
      font-weight: 700;
    }
    .adm-belongs-value{
      font-weight: 900;
      font-size: 18px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }


    .kv { width:100%; border-collapse:collapse; }
    .kv td { border:1px solid #000; padding:8px; vertical-align:middle; }
    .k { width:170px; font-weight:700; }
    .v { font-weight:700; }

    .section-title { text-align:center; font-weight:700; color:#0b3b5f; margin-top:14px; margin-bottom:6px; font-size:14px; }
    .small-note { font-style:italic; margin-top:6px; font-size:12px; }

    /* Cover: 2x2 grid */
    table.quad2x2{
      width: 100%;
      border-collapse: collapse;
      border: 2px solid #000;
      margin-top: 10px;
      table-layout: fixed; /* prevents weird resizing in PDF */
    }

    table.quad2x2 td{
      border: 1px solid #000;
      vertical-align: middle;
    }

    table.quad2x2 td.yaxis{
      width: 52px;
      background: #fff;
      position: relative;
    }

    .yaxis-text{
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-90deg);
      white-space: nowrap;
      font-weight: 700;
      font-size: 14px;
    }

    table.quad2x2 td.cell{
      padding: 14px;
      height: 120px;          /* forces 2×2 shape */
      vertical-align: middle;
    }

    table.quad2x2 td.cell .main{
      font-size: 18px;
      font-weight: 800;
      margin-bottom: 6px;
    }

    table.quad2x2 td.cell .sub{
      font-size: 13px;
      font-weight: 600;
      line-height: 1.2;
    }

    table.quad2x2 td.cell.active{
      border: 4px solid #000; /* highlight student quadrant */
    }

    .x-axis-label{
      margin-left: 58px; /* aligns under grid (≈ y-axis cell width) */
      margin-top: 8px;
      font-weight: 700;
      font-size: 14px;
    }

    /* Snapshot table */
    .snap { width:100%; border-collapse:collapse; }
    .snap th, .snap td { border:2px solid #000; padding:8px; text-align:center; font-size:13px; }
    .snap th { background:#fff; font-weight:700; }
    .left { text-align:left; padding-left:10px; }

    /* Page 2 tables (your original style) */
    .table { width:100%; border-collapse:collapse; margin-bottom:6px; }
    .table th, .table td { border:2px solid #000; padding:8px; text-align:center; font-size:13px; }
    .table th { background:#fff; font-weight:700; }
    .measure-left { text-align:left; padding-left:12px; }
    .footer-note { margin-top:8px; font-size:12px; font-style:italic; }
  </style>
</head>

<body>

  <!-- ===================== PAGE 1 (COVER) ===================== -->
  <div class="page">
    <div class="top-row">
      <div style="width:120px;">
        <img class="logo" src="{{ logo_platform_url | default('') }}" alt="Platform Logo" onerror="this.style.display='none'"/>
      </div>
      <div class="title-wrap">
        <h1>{{ report_title }}</h1>
        <div class="school-line">{{ school_name }}</div>
      </div>
      <div style="width:120px; text-align:right;">
        <img class="logo" src="{{ logo_school_url | default('') }}" alt="School Logo" onerror="this.style.display='none'"/>
      </div>
    </div>

    <div class="grid-2col">
      <div class="col card">
        <div class="section-title">ABOUT THE STUDENT</div>
        <table class="kv">
          <tr><td class="k">Name</td><td class="v">{{ name }}</td></tr>
          <tr><td class="k">Gender</td><td class="v">{{ gender }}</td></tr>
          <tr><td class="k">Class</td><td class="v">{{ class }}</td></tr>
          <tr><td class="k">Date of Evaluation</td><td class="v">{{ date }}</td></tr>
        </table>
      </div>

      <div class="col card">
        <div class="section-title">BASIC MEASUREMENTS</div>
        <table class="kv">
          <tr><td class="k">Height (cm)</td><td class="v">{{ height_cm }}</td></tr>
          <tr><td class="k">Weight (kg)</td><td class="v">{{ weight_kg }}</td></tr>
          <tr><td class="k">BMI</td><td class="v">{{ bmi }}</td></tr>
          <tr><td class="k">Total Fitness Score</td><td class="v">{{ fitnessscore }}/{{ maxfitnessscore }}</td></tr>
        </table>
      </div>
    </div>

    <div class="card">
      <div class="section-title">Athletic Development Matrix</div>

      <div class="small-note">
        <b>Foundation</b> = Strength + Flexibility + Balance. &nbsp;
        <b>Movement Skills</b> = Power + Speed &amp; Agility. &nbsp;
        High = score ≥ 4.
      </div>

      <div class="grid-2col adm-row">

        <!-- LEFT: 2x2 grid (60% width) -->
        <div class="col adm-grid">
          <table class="quad2x2">
            <tr>
              <td class="yaxis" rowspan="2">
                <div class="yaxis-text">Movement Skills ↑</div>
              </td>

              <td class="cell {% if level2_grid_2x2 == 'foundation_high_movement_high' %}active{% endif %}">
                <div class="main">Athlete</div>
                <div class="sub">Foundation High<br/>Movement High</div>
              </td>

              <td class="cell {% if level2_grid_2x2 == 'foundation_high_movement_low' %}active{% endif %}">
                <div class="main">Strong but Slow</div>
                <div class="sub">Foundation High<br/>Movement Low</div>
              </td>
            </tr>

            <tr>
              <td class="cell {% if level2_grid_2x2 == 'foundation_low_movement_high' %}active{% endif %}">
                <div class="main">Fast but Fragile</div>
                <div class="sub">Foundation Low<br/>Movement High</div>
              </td>

              <td class="cell {% if level2_grid_2x2 == 'foundation_low_movement_low' %}active{% endif %}">
                <div class="main">Developing</div>
                <div class="sub">Foundation Low<br/>Movement Low</div>
              </td>
            </tr>
          </table>

          <div class="x-axis-label">Foundation →</div>
        </div>

        <!-- RIGHT: score summary box -->
        <div class="col adm-side">
          <div class="adm-side-title">Student Summary</div>

          <div class="adm-metric-line">
            <b>Foundation Score:</b> {{ foundation_score }}
          </div>

          <div class="adm-metric-line">
            <b>Movement Skills Score:</b> {{ movement_skills_score }}
          </div>

          <div class="adm-belongs">
            <div class="adm-belongs-label">Student quadrant:</div>

            {% if level2_grid_2x2 == 'foundation_high_movement_high' %}
              <div class="adm-belongs-value">Athlete</div>
            {% elif level2_grid_2x2 == 'foundation_high_movement_low' %}
              <div class="adm-belongs-value">Strong but Slow</div>
            {% elif level2_grid_2x2 == 'foundation_low_movement_high' %}
              <div class="adm-belongs-value">Fast but Fragile</div>
            {% else %}
              <div class="adm-belongs-value">Developing</div>
            {% endif %}
          </div>

          <div class="adm-note">
            This quadrant reflects the balance between physical foundation and movement skills.
          </div>
        </div>

      </div>
    </div>


        <div class="col">
          <div class="section-title">COMPONENT SNAPSHOT</div>
          <div class="small-note">
            Shows how this student compares to the class <b>Average</b> and <b>80th percentile</b>
            (grouped by Grade &amp; Gender).
          </div>

          <table class="snap" style="margin-top:8px;">
            <thead>
              <tr>
                <th class="left">Component</th>
                <th>Your Score</th>
                <th>Avg</th>
                <th>P80</th>
              </tr>
            </thead>
            <tbody>
              <tr><td class="left">Strength</td><td>{{ strength_score }}</td><td>{{ strength_avg }}</td><td>{{ strength_p80 }}</td></tr>
              <tr><td class="left">Power</td><td>{{ power_score }}</td><td>{{ power_avg }}</td><td>{{ power_p80 }}</td></tr>
              <tr><td class="left">Speed &amp; Agility</td><td>{{ speed_agility_score }}</td><td>{{ speed_agility_avg }}</td><td>{{ speed_agility_p80 }}</td></tr>
              <tr><td class="left">Flexibility</td><td>{{ flexibility_score }}</td><td>{{ flexibility_avg }}</td><td>{{ flexibility_p80 }}</td></tr>
              <tr><td class="left">Balance</td><td>{{ balance_score }}</td><td>{{ balance_avg }}</td><td>{{ balance_p80 }}</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- ===================== PAGE 2 (DETAIL TABLES) ===================== -->
  <div class="page page-break">
    <div class="top-row">
      <div style="width:120px;">
        <img class="logo" src="{{ logo_platform_url | default('') }}" alt="Logo" onerror="this.style.display='none'" />
      </div>
      <div class="title-wrap">
        <h1>{{ report_title }}</h1>
      </div>
      <div style="width:120px;"></div>
    </div>

    <div class="card" style="margin-top:10px;">
      <div class="grid-2col">
        <div class="col">
          <table class="kv">
            <tr><td class="k">School</td><td class="v">{{ school_name }}</td></tr>
            <tr><td class="k">Name</td><td class="v">{{ name }}</td></tr>
            <tr><td class="k">Height</td><td class="v">{{ height_cm }}</td></tr>
            <tr><td class="k">Fitness Score</td><td class="v">{{ fitnessscore }}/{{ maxfitnessscore }}</td></tr>
          </table>
        </div>
        <div class="col">
          <table class="kv">
            <tr><td class="k">Class</td><td class="v">{{ class }}</td></tr>
            <tr><td class="k">Gender</td><td class="v">{{ gender }}</td></tr>
            <tr><td class="k">Weight</td><td class="v">{{ weight_kg }}</td></tr>
            <tr><td class="k">Date</td><td class="v">{{ date }}</td></tr>
          </table>
        </div>
      </div>
    </div>

    <div class="section-title">STRENGTH</div>
    <table class="table">
      <thead>
        <tr>
          <th style="width:6%;">#</th>
          <th style="width:12%;">Limb</th>
          <th style="width:38%;">Criteria</th>
          <th style="width:8%;">Measure</th>
          <th style="width:8%;">Avg</th>
          <th style="width:8%;">P80</th>
          <th style="width:10%;">Best</th>
          <th style="width:10%;">Score (1–5)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1.1</td>
          <td>Lower</td>
          <td class="measure-left">Maximum "chair squats" in 60 seconds</td>
          <td>{{ chair_squat_60s }}</td>
          <td>{{ chair_squat_60s_avg }}</td>
          <td>{{ chair_squat_60s_p80 }}</td>
          <td>{{ chair_squat_60s_best }}</td>
          <td>{{ chair_squat_60s_score }}</td>
        </tr>
        <tr>
          <td>1.2</td>
          <td>Upper</td>
          <td class="measure-left">Maximum Medicine Ball Press in 60 seconds</td>
          <td>{{ oh_mbp_60s }}</td>
          <td>{{ oh_mbp_60s_avg }}</td>
          <td>{{ oh_mbp_60s_p80 }}</td>
          <td>{{ oh_mbp_60s_best }}</td>
          <td>{{ oh_mbp_60s_score }}</td>
        </tr>
      </tbody>
    </table>
    <div class="small-note">*Strength is the ability to produce force against resistance. It is also the foundation for increasing power.</div>

    <div class="section-title">POWER</div>
    <table class="table">
      <thead>
        <tr>
          <th style="width:6%;">#</th>
          <th style="width:12%;">Limb</th>
          <th style="width:38%;">Criteria</th>
          <th style="width:8%;">Measure</th>
          <th style="width:8%;">Avg</th>
          <th style="width:8%;">P80</th>
          <th style="width:10%;">Best</th>
          <th style="width:10%;">Score (1–5)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2.1</td>
          <td>Lower</td>
          <td class="measure-left">Standing Broad Jump Distance</td>
          <td>{{ standing_broad_jump }}</td>
          <td>{{ standing_broad_jump_avg }}</td>
          <td>{{ standing_broad_jump_p80 }}</td>
          <td>{{ standing_broad_jump_best }}</td>
          <td>{{ standing_broad_jump_score }}</td>
        </tr>
        <tr>
          <td>2.2</td>
          <td>Upper</td>
          <td class="measure-left">Seated Medicine Ball Throw Distance</td>
          <td>{{ seated_medicine_ball_throw }}</td>
          <td>{{ seated_medicine_ball_throw_avg }}</td>
          <td>{{ seated_medicine_ball_throw_p80 }}</td>
          <td>{{ seated_medicine_ball_throw_best }}</td>
          <td>{{ seated_medicine_ball_throw_score }}</td>
        </tr>
      </tbody>
    </table>
    <div class="small-note">Power is strength applied at speed.</div>

    <div class="section-title">SPEED &amp; AGILITY</div>
    <table class="table">
      <thead>
        <tr>
          <th style="width:6%;">#</th>
          <th style="width:12%;">Test</th>
          <th style="width:38%;">Criteria</th>
          <th style="width:8%;">Measure</th>
          <th style="width:8%;">Avg</th>
          <th style="width:8%;">P80</th>
          <th style="width:10%;">Best</th>
          <th style="width:10%;">Score (1–5)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>3.1</td>
          <td>20m Sprint</td>
          <td class="measure-left">Maximum running speed</td>
          <td>{{ sprint_20m }}</td>
          <td>{{ sprint_20m_avg }}</td>
          <td>{{ sprint_20m_p80 }}</td>
          <td>{{ sprint_20m_best }}</td>
          <td>{{ sprint_20m_score }}</td>
        </tr>
        <tr>
          <td>3.2</td>
          <td>Pro Agility</td>
          <td class="measure-left">Change direction, accelerate &amp; decelerate</td>
          <td>{{ pro_agility_505 }}</td>
          <td>{{ pro_agility_505_avg }}</td>
          <td>{{ pro_agility_505_p80 }}</td>
          <td>{{ pro_agility_505_best }}</td>
          <td>{{ pro_agility_505_score }}</td>
        </tr>
      </tbody>
    </table>

    <div class="section-title">FLEXIBILITY</div>
    <table class="table">
      <thead>
        <tr>
          <th style="width:6%;">#</th>
          <th style="width:12%;">Limb</th>
          <th style="width:40%;">Criteria</th>
          <th style="width:8%;">Measure (1–3)</th>
          <th style="width:8%;">Avg</th>
          <th style="width:8%;">P80</th>
          <th style="width:8%;">Best</th>
          <th style="width:10%;">Score (1–5)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>4.1</td>
          <td>Lower</td>
          <td class="measure-left">Active Straight Leg Raise (SLR)</td>
          <td>{{ straight_leg_raise }}</td>
          <td>{{ straight_leg_raise_avg }}</td>
          <td>{{ straight_leg_raise_p80 }}</td>
          <td>{{ straight_leg_raise_best }}</td>
          <td>{{ straight_leg_raise_score }}</td>
        </tr>
        <tr>
          <td>4.2</td>
          <td>Upper</td>
          <td class="measure-left">Shoulder Mobility</td>
          <td>{{ shoulder_mobility }}</td>
          <td>{{ shoulder_mobility_avg }}</td>
          <td>{{ shoulder_mobility_p80 }}</td>
          <td>{{ shoulder_mobility_best }}</td>
          <td>{{ shoulder_mobility_score }}</td>
        </tr>
      </tbody>
    </table>

    <div class="section-title">BALANCE</div>
    <table class="table">
      <thead>
        <tr>
          <th style="width:6%;">#</th>
          <th style="width:40%;">Criteria</th>
          <th style="width:8%;">Measure (sec)</th>
          <th style="width:8%;">Avg</th>
          <th style="width:8%;">P80</th>
          <th style="width:8%;">Best</th>
          <th style="width:10%;">Score (1–5)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>5.1</td>
          <td class="measure-left">Stand on one leg, eyes open (max 30 sec)</td>
          <td>{{ balance_eyes_open }}</td>
          <td>{{ balance_eyes_open_avg }}</td>
          <td>{{ balance_eyes_open_p80 }}</td>
          <td>{{ balance_eyes_open_best }}</td>
          <td>{{ balance_eyes_open_score }}</td>
        </tr>
      </tbody>
    </table>

    <div class="footer-note">
      Interpretation tip: use the cover page to see whether to prioritize Foundation (strength/flexibility/balance)
      or Movement Skills (power/speed/agility).
    </div>
  </div>

</body>
</html>
